<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!-- 文件输出格式 -->
    <property name="LOG_FORMAT_PATTERN" value="%-12(%d{yyyy-MM-dd HH:mm:ss.SSS}) |-%-5level [%thread] %c [%L] -| %msg%n" />

    <!--定义日志文件的存储地址 勿在 LogBack 的配置中使用相对路径     使用spring-boot的配置项LOG_PATH-->
    <property name="LOG_HOME" value="F:\workspace\logs"/>
    <!--<property name="LOG_HOME" value="/var/log/apeye"/>-->

    <property name="DEV_LOG_LEVEL" value="INFO" />
    <property name="TEST_LOG_LEVEL" value="INFO" />
    <property name="PROD_LOG_LEVEL" value="INFO" />

    <!-- 开发环境 -->
    <springProfile name="dev">
        <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
            <encoder>
                <pattern>${LOG_FORMAT_PATTERN}</pattern>
            </encoder>
        </appender>

        <logger name="com.client.*" level="debug" />

        <root level="${DEV_LOG_LEVEL}">
            <appender-ref ref="CONSOLE" />
        </root>
    </springProfile>

    <springProfile name="test">
        <appender name="ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
            <!-- 文件路径 -->
            <file>${LOG_HOME}/web-server.log</file>
            <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                <!-- rollover daily -->
                <fileNamePattern>${LOG_HOME}/web-server_%d{yyyy-MM-dd}.%i.log
                </fileNamePattern>
                <!-- each file should be at most {maxFileSize}, keep {maxHistory} days worth of history, but at most {totalSizeCap} -->
                <maxFileSize>10MB</maxFileSize>
                <maxHistory>60</maxHistory>
                <totalSizeCap>10000MB</totalSizeCap>
            </rollingPolicy>
            <!-- <layout class="ch.qos.logback.classic.PatternLayout"> <pattern>${LOG_FORMAT_PATTERN}</pattern>
                </layout> -->
            <encoder>
                <pattern>${LOG_FORMAT_PATTERN}</pattern>
            </encoder>
        </appender>

        <root level="${TEST_LOG_LEVEL}">
            <appender-ref ref="ROLLING" />
        </root>
    </springProfile>

    <springProfile name="prod">
        <appender name="ROLLING" class="ch.qos.logback.core.rolling.RollingFileAppender">
            <!-- 文件路径 -->
            <file>${LOG_HOME}/web-server.log</file>
            <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
                <!-- rollover daily -->
                <fileNamePattern>${LOG_HOME}/web-server_%d{yyyy-MM-dd}.%i.log
                </fileNamePattern>
                <!-- each file should be at most {maxFileSize}, keep {maxHistory} days worth of history, but at most {totalSizeCap} -->
                <maxFileSize>10MB</maxFileSize>
                <maxHistory>60</maxHistory>
                <totalSizeCap>10000MB</totalSizeCap>
            </rollingPolicy>
            <!-- <layout class="ch.qos.logback.classic.PatternLayout"> <pattern>${LOG_FORMAT_PATTERN}</pattern>
                </layout> -->
            <encoder>
                <pattern>${LOG_FORMAT_PATTERN}</pattern>
            </encoder>
        </appender>

        <logger name="org.springframework" level="INFO"/>
        <logger name="org.springframework.transaction" level="DEBUG"/>
        <logger name="com.qdyx" level="DEBUG"/>
        <logger name="java.sql.Connection" level="INFO"/>
        <logger name="java.sql.Statement" level="INFO"/>
        <logger name="java.sql.PreparedStatement" level="INFO"/>

        <root level="${PROD_LOG_LEVEL}">
            <appender-ref ref="ROLLING" />
        </root>
    </springProfile>
</configuration>
